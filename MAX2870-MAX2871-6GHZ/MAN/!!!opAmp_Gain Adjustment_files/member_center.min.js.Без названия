var profileCallback=function(){updateAvatar();
getAddressValues();
getProfileFieldValues();
setPasswordInfo();
getInterestsValues()
};
function updateAvatar(){var a=CQ_Analytics.PersonalInfoStoreMgr.getValue("avatar");
if(a.indexOf("/_images/profile_icon.png")>0){a="/etc/designs/maximintegrated/_images/150.png"
}$("#avatar").attr("src",a);
$("#mymi-icon").attr("src",a);
$("#authorizableId").val(CQ_Analytics.PersonalInfoStoreMgr.getProperty("authorizableId"));
if(typeof personalInfoLink!="undefined"&&typeof personalInfoLink.uploadFinishedPath!="undefined"){$("#redirect").val(personalInfoLink.uploadFinishedPath)
}}function refreshAvatar(a){$("#avatar").attr("src",a);
$("#mymi-icon").attr("src",a);
saveCacheProperty("avatar",a);
$("#myMaximUploadPhoto").modal("hide")
}function tryRefreshAvatar(){window.setTimeout(function(){if($("#myMaximUploadPhoto").is(":visible")){var d=$("#upload_target").contents().find("html").html();
console.log(d);
if(d.indexOf("window.refreshAvatar")>0){var e=d.indexOf("refreshAvatar('")+15;
var c=d.substring(e);
var a=c.indexOf("');");
var b=c.substring(0,a);
refreshAvatar(b.replace(/amp;/g,""))
}else{tryRefreshAvatar()
}}},1000)
}function removeAvatar(){$("#avatar-spinner").show();
jQuery.ajax({url:"/bin/AvatarModificationServlet?cmd=remove&authorizableId="+CQ_Analytics.PersonalInfoStoreMgr.getProperty("authorizableId"),dataType:"json",type:"get",xhrFields:{withCredentials:true},success:function(a){if(a.status){if(CQ_Analytics.PersonalInfoStoreMgr&&typeof personalInfoLink!="undefined"&&typeof personalInfoLink.url!="undefined"){CQ_Analytics.PersonalInfoStoreMgr.init(personalInfoLink.url,updateAvatar)
}}else{alert(a.error)
}},complete:function(a,b){$("#avatar-spinner").hide()
},error:function(b,a){if(b.status===0){alert("Not connect. Verify Network.")
}else{if(b.status==404){alert("Requested page not found. [404]")
}else{if(b.status==401||b.status==403){alert("Not authenticated.")
}else{if(b.status==500){alert("Internal Server Error [500].")
}else{if(a==="parsererror"){alert("Requested JSON parse failed.")
}else{if(a==="timeout"){alert("Time out error.")
}else{if(a==="abort"){alert("Ajax request aborted.")
}else{alert("Uncaught Error: "+b.responseText)
}}}}}}}}})
}function getProfileFieldValues(){$("#firstName").text(CQ_Analytics.PersonalInfoStoreMgr.getProperty("givenName"));
$("#lastName").text(CQ_Analytics.PersonalInfoStoreMgr.getProperty("familyName"));
$("#company").text(CQ_Analytics.PersonalInfoStoreMgr.getProperty("company",true));
$("#role").text(CQ_Analytics.PersonalInfoStoreMgr.getProperty("role"));
$("#phone").text(CQ_Analytics.PersonalInfoStoreMgr.getProperty("phone"))
}function setProfileFieldValues(){$("#fName").val(CQ_Analytics.PersonalInfoStoreMgr.getProperty("givenName"));
$("#lName").val(CQ_Analytics.PersonalInfoStoreMgr.getProperty("familyName"));
$("#companyName").val(CQ_Analytics.PersonalInfoStoreMgr.getProperty("company",true));
$("#roleName").val(CQ_Analytics.PersonalInfoStoreMgr.getProperty("role"));
$("#phoneNumber").val(CQ_Analytics.PersonalInfoStoreMgr.getProperty("phone"))
}function updatePersonalInfo(){var g=$("#fName").val();
var c=$("#lName").val();
var b=$("#companyName").val();
var f=$("#roleName").val();
var a=$("#phoneNumber").val();
var e=CQ_Analytics.PersonalInfoStoreMgr.getProperty("authorizableId");
if(!containsOnlyAscii(g)||!containsOnlyAscii(c)||!containsOnlyAscii(b)||!containsOnlyAscii(f)||!containsOnlyAscii(a)){alert("Only English is allowed.");
return
}var d="authorizableId="+encodeURIComponent(e)+"&"+encodeURIComponent("profile/givenName")+"="+encodeURIComponent(g)+"&"+encodeURIComponent("profile/familyName")+"="+encodeURIComponent(c)+"&"+encodeURIComponent("profile/company")+"="+encodeURIComponent(b)+"&"+encodeURIComponent("profile/role")+"="+encodeURIComponent(f)+"&"+encodeURIComponent("profile/phone")+"="+encodeURIComponent(a);
$("#profile-spinner").show();
jQuery.ajax({url:"/bin/AccountModificationServlet",type:"POST",contentType:"application/x-www-form-urlencoded",data:d,success:function(h){if(h.status){$("#myMaximProfileInfo").modal("hide");
if(CQ_Analytics.PersonalInfoStoreMgr&&typeof personalInfoLink!="undefined"&&typeof personalInfoLink.url!="undefined"){CQ_Analytics.PersonalInfoStoreMgr.init(personalInfoLink.url,getProfileFieldValues)
}}else{alert(h.error)
}},complete:function(h,i){$("#profile-spinner").hide()
},error:function(i,h){if(i.status===0){alert("Not connect. Verify Network.")
}else{if(i.status==404){alert("Requested page not found. [404]")
}else{if(i.status==500){alert("Internal Server Error [500].")
}else{if(h==="parsererror"){alert("Requested JSON parse failed.")
}else{if(h==="timeout"){alert("Time out error.")
}else{if(h==="abort"){alert("Ajax request aborted.")
}else{alert("Uncaught Error: "+i.responseText)
}}}}}}}})
}function getAddressValues(){$("#profileAddress1").text(CQ_Analytics.PersonalInfoStoreMgr.getProperty("address1"));
$("#profileAddress2").text(CQ_Analytics.PersonalInfoStoreMgr.getProperty("address2"));
$("#profileCity").text(CQ_Analytics.PersonalInfoStoreMgr.getProperty("city"));
$("#profileState").text(CQ_Analytics.PersonalInfoStoreMgr.getProperty("state"));
$("#profileZip").text(CQ_Analytics.PersonalInfoStoreMgr.getProperty("postalCode"));
$("#profileCountry").text(CQ_Analytics.PersonalInfoStoreMgr.getProperty("country"))
}function setAddressValues(){$("#address1").val(CQ_Analytics.PersonalInfoStoreMgr.getProperty("address1"));
$("#address2").val(CQ_Analytics.PersonalInfoStoreMgr.getProperty("address2"));
$("#city").val(CQ_Analytics.PersonalInfoStoreMgr.getProperty("city"));
populateProfileCountry("profileEndCustomerCountryDiv","profileEndCustomerCountry","profileEndCustomerStateDiv","profileEndCustomerState");
populateProfileStateAddress("stateDiv","stateProvince",CQ_Analytics.PersonalInfoStoreMgr.getProperty("country"));
$("#stateProvince").val(CQ_Analytics.PersonalInfoStoreMgr.getProperty("state"));
$("#zipPostal").val(CQ_Analytics.PersonalInfoStoreMgr.getProperty("postalCode"));
$("#country").val(CQ_Analytics.PersonalInfoStoreMgr.getProperty("country"))
}function sortResults(a,c,b){a=a.sort(function(e,d){if(b){return(e[c]>d[c])?1:((e[c]<d[c])?-1:0)
}else{return(d[c]>e[c])?1:((d[c]<e[c])?-1:0)
}});
return a
}function populateProfileCountry(d,a,b,c){$.ajax({type:"post",url:"/bin/address",data:"input=getCountry",success:function(k){var h=jQuery.parseJSON(k);
var e=sortResults(h.country,"name","asc");
var g='<label for="addressCountry" class="smallest">'+Granite.I18n.get("country")+'<font color="red"><b>*</b></font></label><select id="'+a+'" onchange="populateProfileState(&quot;'+b+"&quot;,&quot;"+c+"&quot;,&quot;"+a+'&quot;)" name="'+a+'" class="form-control required" aria-required="true"><option  selected></option>';
for(var f=0;
f<e.length;
f++){var j=e[f];
g=g+'<option class="form-control" data-iso-val="'+j.name+'" value="'+j.countryIsoCode+'" data-taxIdRequired="'+j.taxIdRequired+'">'+j.name+"</option>"
}g=g+"</select>";
if($("[id=profileEndCustomerCountry]").length===0){$("#"+d).html(g)
}}})
}function populateProfileState(b,f,e){var c=$("#"+e+" option:selected");
var a=c.data("taxidrequired");
if(a==true){$("#vat").show()
}var d=$("#"+e+" option:selected").val();
$.ajax({type:"POST",url:"/bin/MiscUtilsServlet",data:"cmd=region&ccode="+d,dataType:"json",success:function(h){$("#"+b).show();
var g='<label for="addressState" class="smallest">'+Granite.I18n.get("stateRegion")+"</label><br/>";
if(h.items){g=g+'<select class="form-control required" name=\''+f+"' id='"+f+"'>";
for(var j=0;
j<h.items.length;
j++){var i=h.items[j].value;
if(i==""){g=g+'<option class="form-control" value="" class="form-control">'+h.items[j].label+"</option>"
}else{g=g+'<option class="form-control" value="'+h.items[j].label+'" class="form-control">'+h.items[j].label+"</option>"
}}g=g+"<select>"
}if(h.items!=undefined){$("#"+b).html(g);
$("#"+b).html(g)
}else{$("#"+b).html(g);
$("#"+b).hide()
}},error:function(g,i,h){$("#"+b).empty();
$("#"+b).hide()
}})
}function updateAddressInfo(){var c=$("#address1").val();
var a=$("#address2").val();
var h=$("#city").val();
var b=$("#stateProvince").val();
if(b==undefined){b=""
}var e=$("#zipPostal").val();
var g=$("#country").val();
if(!containsOnlyAscii(c)||!containsOnlyAscii(a)||!containsOnlyAscii(h)||!containsOnlyAscii(b)||!containsOnlyAscii(e)||!containsOnlyAscii(g)){alert("Only English is allowed.");
return
}var f=CQ_Analytics.PersonalInfoStoreMgr.getProperty("authorizableId");
var d="authorizableId="+encodeURIComponent(f)+"&"+encodeURIComponent("profile/address1")+"="+encodeURIComponent(c)+"&"+encodeURIComponent("profile/address2")+"="+encodeURIComponent(a)+"&"+encodeURIComponent("profile/city")+"="+encodeURIComponent(h)+"&"+encodeURIComponent("profile/state")+"="+encodeURIComponent(b)+"&"+encodeURIComponent("profile/postalCode")+"="+encodeURIComponent(e)+"&"+encodeURIComponent("profile/country")+"="+encodeURIComponent(g);
$("#address-spinner").show();
jQuery.ajax({url:"/bin/AccountModificationServlet",type:"POST",contentType:"application/x-www-form-urlencoded",data:d,success:function(i){if(i.status){$("#myMaximAddressInfo").modal("hide");
if(CQ_Analytics.PersonalInfoStoreMgr&&typeof personalInfoLink!="undefined"&&typeof personalInfoLink.url!="undefined"){CQ_Analytics.PersonalInfoStoreMgr.init(personalInfoLink.url,getAddressValues)
}}else{alert(i.error)
}},complete:function(i,j){$("#address-spinner").hide()
},error:function(j,i){if(j.status===0){alert("Not connect. Verify Network.")
}else{if(j.status==404){alert("Requested page not found. [404]")
}else{if(j.status==500){alert("Internal Server Error [500].")
}else{if(i==="parsererror"){alert("Requested JSON parse failed.")
}else{if(i==="timeout"){alert("Time out error.")
}else{if(i==="abort"){alert("Ajax request aborted.")
}else{alert("Uncaught Error: "+j.responseText)
}}}}}}}})
}function setPasswordInfo(){$("#userid").text(CQ_Analytics.PersonalInfoStoreMgr.getProperty("authorizableId"));
$("#uid_email").text(CQ_Analytics.PersonalInfoStoreMgr.getProperty("authorizableId"));
$("#current_email").text(CQ_Analytics.PersonalInfoStoreMgr.getProperty("authorizableId"))
}function modifyPassword(){var a=$("#old_password").val().trim();
var b=$("#password").val().trim();
var d=$("#confirmPassword").val().trim();
var h=getUrlLanguage();
var c="";
var g="";
if(a==""){switch(h){case"ja":c+="旧パスワードが入力されていません。\n";
break;
case"zh":c+="请输入旧密码。\n";
break;
default:c+="Old password is empty.\n";
break
}}if(b==""){switch(h){case"ja":c+="新規パスワードが入力されていません。\n";
break;
case"zh":c+="请输入新密码。\n";
break;
default:c+="New password is empty.\n";
break
}}if(b!=d){c+=Granite.I18n.get("pwdnotmatch")+"\n"
}if(c!=""){alert(c)
}else{var f=CQ_Analytics.PersonalInfoStoreMgr.getProperty("authorizableId");
var e="authorizableId="+encodeURIComponent(f)+"&oldpwd="+encodeURIComponent(a)+"&pwd="+encodeURIComponent(b)+"&cmpwd="+encodeURIComponent(d);
$("#changepwd-spinner").show();
jQuery.ajax({url:"/bin/ModifyPasswordServlet",type:"POST",contentType:"application/x-www-form-urlencoded",data:e,success:function(i){if(i.status){switch(h){case"ja":g+="パスワードが変更されました。";
break;
case"zh":g+="密码更改成功。";
break;
default:g+="Password has been modified successfully.";
break
}alert(g);
$("#modifyPwdModal").modal("hide")
}else{c="";
if(i.error.indexOf("Failed to change password")>=0){switch(h){case"ja":c+="パスワードの変更ができませんでした。旧パスワードが正しくありません。";
break;
case"zh":c+="更改密码失败：旧密码不正确。";
break;
default:c+=i.error;
break
}}alert(c)
}},complete:function(i,j){$("#changepwd-spinner").hide()
},error:function(j,i){if(j.status===0){alert("Not connect. Verify Network.")
}else{if(j.status==404){alert("Requested page not found. [404]")
}else{if(j.status==401||j.status==403){alert("Not authenticated.")
}else{if(j.status==500){alert("Internal Server Error [500].")
}else{if(i==="parsererror"){alert("Requested JSON parse failed.")
}else{if(i==="timeout"){alert("Time out error.")
}else{if(i==="abort"){alert("Ajax request aborted.")
}else{alert("Uncaught Error: "+j.responseText)
}}}}}}}}})
}}function showModifyEmail(){$("#modifyPwdModal").modal("hide");
$("#modifyEmailModal").modal("show")
}function modifyEmail(){var d=$("#new_email").val().trim();
var b=$("#repeat_new_email").val().trim();
var a=$("#currentPassword").val().trim();
var c="";
if(!containsOnlyAscii(d)){c+="Only English is allowed.\n"
}if(d==""){c+=Granite.I18n.get("emailempty")+"\n"
}if(a==""){c+=Granite.I18n.get("pwdempty")+"\n"
}if(b!=d){c+=Granite.I18n.get("emailnotmatch")+"\n"
}if(d!=""&&!validateEmail(d)){c+=Granite.I18n.get("emailnotvalid").replace("xxx",d)+"\n"
}if(c!=""){alert(c)
}else{var g=CQ_Analytics.PersonalInfoStoreMgr.getProperty("authorizableId");
var f=getUrlLanguage();
var e="authorizableId="+encodeURIComponent(g)+"&lang="+encodeURIComponent(f)+"&new_email="+encodeURIComponent(d)+"&confirm_email="+encodeURIComponent(b)+"&password="+encodeURIComponent(a);
$("#changeemail-spinner").show();
jQuery.ajax({url:"/bin/ModifyUserIdServlet",type:"POST",contentType:"application/x-www-form-urlencoded",data:e,success:function(h){if(h.status){alert(Granite.I18n.get("modifyemailmsg"));
$("#modifyEmailModal").modal("hide")
}else{alert(h.error)
}},complete:function(h,i){$("#changeemail-spinner").hide()
},error:function(i,h){if(i.status===0){alert("Not connect. Verify Network.")
}else{if(i.status==404){alert("Requested page not found. [404]")
}else{if(i.status==401||i.status==403){alert("Not authenticated.")
}else{if(i.status==500){alert("Internal Server Error [500].")
}else{if(h==="parsererror"){alert("Requested JSON parse failed.")
}else{if(h==="timeout"){alert("Time out error.")
}else{if(h==="abort"){alert("Ajax request aborted.")
}else{alert("Uncaught Error: "+i.responseText)
}}}}}}}}})
}}function subscribe(){var b=CQ_Analytics.PersonalInfoStoreMgr.getProperty("subscription");
if($(".productInfo").is(":checked")){alert(CQ_Analytics.PersonalInfoStoreMgr.getProperty("subscription"));
if(b!="productInfo"){var a="productinfo"
}}}function getInterestsValues(){var c=CQ_Analytics.PersonalInfoStoreMgr.getProperty("interests");
var a=c.split(",");
var b=0;
for(b=0;
b<=a.length;
b++){if($("#checkallPower").val()==a[b]){$("#checkallPower").prop("checked",true)
}if($("#checkallAnalog").val()==a[b]){$("#checkallAnalog").prop("checked",true)
}if($("#checkallInterface").val()==a[b]){$("#checkallInterface").prop("checked",true)
}if($("#checkallDigital").val()==a[b]){$("#checkallDigital").prop("checked",true)
}if($("#checkallCommunications").val()==a[b]){$("#checkallCommunications").prop("checked",true)
}if($("#checkallIndustries").val()==a[b]){$("#checkallIndustries").prop("checked",true)
}if($("#checkallAutomotive").val()==a[b]){$("#checkallAutomotive").prop("checked",true)
}if($("#checkallCommunicationsNetworking").val()==a[b]){$("#checkallCommunicationsNetworking").prop("checked",true)
}if($("#checkallComputing").val()==a[b]){$("#checkallComputing").prop("checked",true)
}if($("#checkallConsumerElectronics").val()==a[b]){$("#checkallConsumerElectronics").prop("checked",true)
}if($("#checkallEnergy").val()==a[b]){$("#checkallEnergy").prop("checked",true)
}if($("#checkallIndustrial").val()==a[b]){$("#checkallIndustrial").prop("checked",true)
}if($("#checkallMedical").val()==a[b]){$("#checkallMedical").prop("checked",true)
}if($("#checkallMilitaryAerospace").val()==a[b]){$("#checkallMilitaryAerospace").prop("checked",true)
}}}function updateProductPreferences(){var a=$('input[name="interest"]:checked').map(function(){return this.value
}).get();
var d=a;
var c=CQ_Analytics.PersonalInfoStoreMgr.getProperty("authorizableId");
var b="authorizableId="+encodeURIComponent(c)+"&"+encodeURIComponent("profile/interests")+"="+encodeURIComponent(d);
jQuery.ajax({url:"/bin/AccountModificationServlet",type:"POST",contentType:"application/x-www-form-urlencoded",data:b,success:function(e){if(e.status){CQ_Analytics.PersonalInfoStoreMgr.setProperty("interests",d)
}else{alert(e.error)
}},error:function(f,e){if(f.status===0){alert("Not connect. Verify Network.")
}else{if(f.status==404){alert("Requested page not found. [404]")
}else{if(f.status==500){alert("Internal Server Error [500].")
}else{if(e==="parsererror"){alert("Requested JSON parse failed.")
}else{if(e==="timeout"){alert("Time out error.")
}else{if(e==="abort"){alert("Ajax request aborted.")
}else{alert("Uncaught Error: "+f.responseText)
}}}}}}}})
}function subscribePref(){var b=CQ_Analytics.PersonalInfoStoreMgr.getProperty("subscriptions");
var e=getUrlLanguage();
var d="";
switch(e){case"ja":d+="Maximはサービス利用規約を更新しました。引き続きMyMaximアカウントを利用するために承諾および同意をお願い申し上げます。";
break;
case"zh":d+="我们的条款已更新。如您不接受条款，您的账号将有部分功能不能使用。";
break;
default:d+="We have updated our terms of service. Please accept and consent to continue to use your MyMaxim account.";
break
}if(b=="true"){$("#product_info").prop("checked",true)
}var a=CQ_Analytics.PersonalInfoStoreMgr.getProperty("policyAcceptance");
if(a=="true"){$("#termAccept").prop("checked",true);
var c=getParameterByName("p");
if(c!=null&&c!=""){window.location=c
}}else{$("#termAcceptText").attr("style","color:red");
window.setTimeout(function(){alert(d)
},1000)
}}function updateTermAccept(){var b=$("#termAccept").is(":checked")?"true":"false";
var f=getUrlLanguage();
var e="";
switch(f){case"ja":e+="規約および条件の承諾を望まない場合、お客様のアカウントは制限されます。";
break;
case"zh":e+="如您不接受条款，您的账号将有部分功能不能使用。";
break;
default:e+="If you do not wish to accept the terms and conditions, your account will be limited.";
break
}if("false"==b){var a=confirm(e);
if(a==false){$("#termAccept").prop("checked",true);
b="true"
}}if("true"==b){$("#termAcceptText").removeAttr("style")
}var d=CQ_Analytics.PersonalInfoStoreMgr.getProperty("authorizableId");
var c="authorizableId="+encodeURIComponent(d)+"&profile/policyAcceptance="+encodeURIComponent(b);
jQuery.ajax({url:"/bin/AccountModificationServlet",type:"POST",contentType:"application/x-www-form-urlencoded",data:c,success:function(g){if(g.status){if("false"==b){logout()
}else{CQ_Analytics.PersonalInfoStoreMgr.setProperty("policyAcceptance",b)
}}else{alert(g.error)
}},error:function(h,g){if(h.status===0){alert("Not connect. Verify Network.")
}else{if(h.status==404){alert("Requested page not found. [404]")
}else{if(h.status==500){alert("Internal Server Error [500].")
}else{if(g==="parsererror"){alert("Requested JSON parse failed.")
}else{if(g==="timeout"){alert("Time out error.")
}else{if(g==="abort"){alert("Ajax request aborted.")
}else{alert("Uncaught Error: "+h.responseText)
}}}}}}}})
}function updateSubscriptions(){var a=$("#product_info").is(":checked")?"true":"false";
var d=a;
var c=CQ_Analytics.PersonalInfoStoreMgr.getProperty("authorizableId");
var b="authorizableId="+encodeURIComponent(c)+"&"+encodeURIComponent("profile/subscriptions")+"="+encodeURIComponent(d);
jQuery.ajax({url:"/bin/AccountModificationServlet",type:"POST",contentType:"application/x-www-form-urlencoded",data:b,success:function(e){if(e.status){CQ_Analytics.PersonalInfoStoreMgr.setProperty("subscriptions",d)
}else{alert(e.error)
}},error:function(f,e){if(f.status===0){alert("Not connect. Verify Network.")
}else{if(f.status==404){alert("Requested page not found. [404]")
}else{if(f.status==500){alert("Internal Server Error [500].")
}else{if(e==="parsererror"){alert("Requested JSON parse failed.")
}else{if(e==="timeout"){alert("Time out error.")
}else{if(e==="abort"){alert("Ajax request aborted.")
}else{alert("Uncaught Error: "+f.responseText)
}}}}}}}})
};